# 開発ワークフロー

## 基本方針

- ウォーターフォール型 + V字モデルに基づくテスト設計
- 設計先行：設計書完成後に実装開始
- TDD：テストケース先行で実装

## 開発フロー概要

```
1. 要件定義（/requirements skill必須） → 2. 基本設計（/system-design skill必須）
→ 3. 詳細設計（/feature-spec skill必須）
→ 4. 単体テストケース（大枠）記載 → 5. TDD実装（テスト追加時は設計書を先に更新）
→ 6. E2Eテストケース作成 → 7. E2Eテスト実装 → 8. PRマージ
```

### Skill呼び出しルール

設計ドキュメントの**新規作成・大幅修正**時は、必ず対応するskillを呼び出すこと。
既存ドキュメントのパターンを真似るだけでは、テンプレートの変更や必須項目の漏れを引き継ぐリスクがある。

| 作業 | 必須skill | 理由 |
|------|-----------|------|
| 要件定義書の作成・修正 | `/requirements` | テンプレート・機能一覧構造のロード |
| 基本設計書の作成・修正 | `/system-design` | テンプレート・設計構造のロード |
| 詳細設計書の作成・修正 | `/feature-spec` | テンプレート・セルフチェックリストのロード |
| 作業見積もりの追加 | `/feature-spec-estimate-cost` | 見積もりテンプレートのロード |

## 実装開始条件

- feature-spec全セクション記載済
- 単体テストケース（大枠）記載済
- バックエンド機能: openapi.yaml更新済

## 実装中の原則

- **設計先行**: 変更が必要な場合は設計書を先に更新
- **TDDサイクル**: テストケースを追加する場合は、先に詳細設計書のテストケースセクションを更新してからテストコードを実装する

## タスク実行フロー

### 1. チケット開始時
- 詳細設計書（`./docs/features/xxx.md`）を読み込む
- 完了条件を確認する
- 不明点があれば必ずユーザーに質問する

### 2. 実装中
- 設計書を常に参照する
- 疑問が生じたら即座にユーザーに質問する
- 気づき・判断・変更点はチケットにコメントとして記録

### 3. 完了前レビュー
- 完了条件を全て満たしたか確認
- レビュー観点を提示してユーザーにレビュー依頼
- **ユーザーの承認を確認してから**Gitコミットを実行する
- フィードバックがあれば修正し、再度レビュー依頼

**レビュー観点のテンプレート**

- [項目] 具体的なファイルや機能
  - 概要: 一目でわかる内容
  - 変更差分:
    - 変更内容1
    - 変更内容2
- [項目] 具体的なファイルや機能
  - 概要: 一目でわかる内容
  - 変更差分:
    - 変更内容1

### 4. チケットクローズ
- レビュー承認後にGitコミット実行
- チケットの「やったこと」欄に実施内容を記載
- チケットステータスを更新して完了

## Gitコミットのフロー

1. **完了条件確認** → レビュー観点を整理
2. **レビュー依頼** → ユーザーにレビュー観点を提示
3. **承認待ち** → ユーザーの承認（「OK」「進めて」など）を待つ
4. **コミット実行** → 承認後に初めてGitコミットを実行

## 詳細手順

詳細なフロー・チェックリスト・V字モデル対応は `/workflow` skillを参照。
