---
name: review-spec
description: 詳細設計書（feature-spec）の整合性レビュー。セクション間の漏れ・不整合を検出します。
disable-model-invocation: true
---

# Review Spec Skill

## 概要

詳細設計書（`docs/functions/<category>/<name>.md`）の整合性をレビューするSkillです。
変更を加えた後に `/review-spec <ファイルパス>` で実行し、セクション間の漏れ・不整合を検出します。

## 実行手順

### Step 1: 対象ファイルの読み込み

1. 引数で指定された詳細設計書を読み込む
2. 引数がない場合は、ユーザーに対象ファイルを確認する

### Step 2: テンプレートとの構成比較

`@.claude/skills/feature-spec/SKILL.md` のテンプレートと比較し、以下を確認する。

- セクションの過不足
- セクションの順序（テンプレートの順序に準拠しているか）
- 優先度ラベル（🔴🟡🟢）の有無

**結果をユーザーに報告し、修正が必要な場合は提案する。**

### Step 3: 上位設計書との整合性チェック

以下の上位設計書と比較し、定義の一致を確認する。

| 比較対象 | ファイルパス | 確認項目 |
|----------|-------------|----------|
| データ設計書 | `docs/versions/1_0_0/system_datas.md` | 関連テーブルのカラム定義・データ型 |
| 基本設計書 | `docs/versions/1_0_0/system-design.md` | 機能階層・権限マトリクス |

**結果をユーザーに報告し、不一致がある場合は差分を提示する。**

### Step 4: セクション間の整合性チェック

詳細設計書内の各セクション間でクロスチェックを行う。

#### チェックマトリクス

以下の5つのセクションを相互に比較し、漏れを検出する。

| 比較元 ＼ 比較先 | フロー図 | シーケンス図 | 機能要件 | ユースケース | テストケース |
|------------------|:--------:|:------------:|:--------:|:------------:|:------------:|
| **フロー図**     | -        | ○           | ○       | ○           | ○           |
| **シーケンス図** | ○       | -            | ○       | ○           | ○           |
| **機能要件**     | ○       | ○           | -        | ○           | ○           |
| **ユースケース** | ○       | ○           | ○       | -            | ○           |
| **テストケース** | ○       | ○           | ○       | ○           | -            |

#### チェック手順

1. フロー図・シーケンス図から全機能項目を抽出する
2. 各セクションに対応する記載があるか確認する
3. 漏れがある項目をマトリクス形式で一覧化する

**報告フォーマット:**

```
| 項目 | フロー図 | シーケンス図 | 機能要件 | ユースケース | テストケース | 状態 |
|------|----------|--------------|----------|--------------|--------------|------|
| xxx  | ○       | ○           | ○       | ×           | ○           | 漏れ |
```

**漏れがある場合は修正案を提示し、ユーザーの承認後に修正する。**

### Step 5: 結果サマリ

全Stepの結果をまとめて報告する。

```
## レビュー結果サマリ

- テンプレート準拠: OK / NG（N件）
- 上位設計書との整合性: OK / NG（N件）
- セクション間の整合性: OK / NG（N件の漏れ）
```

## 注意事項

- 修正はユーザーの承認後に行う
- 「TBD」の項目は漏れとして扱わない
- テストケースの詳細（TDD実装時・E2E実装完了後に記載する項目）は漏れとして扱わない
