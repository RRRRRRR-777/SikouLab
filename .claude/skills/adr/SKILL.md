---
name: adr
description: Architecture Decision Record (ADR) を作成するSkill。技術的決定を標準化されたテンプレートで文書化します。
---

# ADR (Architecture Decision Record) Skill

## 概要

技術的決定をADRとして `docs/adr/{番号}-{短縮名}.md` に作成するSkillです。

**ADRの目的**: アーキテクチャ決定の背景・理由・影響を文書化し、チーム内の意思決定の透明性と一貫性を維持する。

## 既存ADRの確認

作成前に、既存のADRを確認して重複を防ぎます：

```bash
ls -la docs/adr/
```

現在の最新ADR番号を確認し、次の番号を付与します（例: 001〜013が存在 → 次は014）

## 必須入力

このSkillを呼び出す際は、以下の情報を提供してください：

| 項目 | 説明 | 例 |
|------|------|-----|
| **決定事項** | 何を決定したいか | 「Markdownライブラリの選定」 |
| **コンテキスト** | 背景・問題・要件（あれば） | 「記事機能でMarkdown表示とエディタが必要」 |
| **候補** | 検討している選択肢（あれば） | 「react-markdown, marked, MDX...」 |
| **制約** | 技術・ビジネスの制約（あれば） | 「実装コスト最小化」「Next.js 15対応」 |

## 情報が不足している場合の処理

以下の情報が不足している場合は、**ask skillを呼び出して**インタビュー型プロンプティングにより情報を収集します：

| 不足情報 | ask skillで確認する内容 |
|----------|------------------------|
| **決定事項が不明確** | 何を決定したいのか、どの層の決定か（ライブラリ/アーキテクチャ/データストア等） |
| **コンテキスト不足** | 背景・問題・要件・制約・誰がどう困っているのか |
| **候補が不明** | 既に調査済みの選択肢、検討除外した理由 |
| **評価軸が不明** | 何を基準に比較するか（コスト/パフォーマンス/スケーラビリティ等） |
| **ステータスが不明** | 決定済みか、提案段階か、チームレビュー待ちか |

### ask skillの呼び出し例

```
以下のADR作成に必要な情報を収集するため、ask skillによるインタビューを実施してください。

決定事項: {ユーザーから提供された決定事項}
現在の情報: {ユーザーから提供されたコンテキスト・候補・制約}

特に以下の点を明確にしてください：
- 背景と課題
- 技術・ビジネス制約
- 比較評価軸
- 既に検討した選択肢
```

## 出力ファイル構成

```
docs/adr/
└── {三位数番号}-{短縮名}.md
```

**命名規則**: 三位数の連番（001, 002, ...） + ハイフン + 英語短縮名（ケバブケース）

例：
- `docs/adr/001-ui-library.md`
- `docs/adr/013-markdown-library.md`
- `docs/adr/014-auth-provider.md`

## 出力テンプレート

```markdown
# ADR-{番号}: {決定事項タイトル}

## ステータス
承認済み / 提案中 / 却下 / 保留 / 置換

## コンテキスト
{背景・問題・要件・制約}

## 決定
**{選択した技術・アプローチ}** を採用する。

### 詳細構成

| 用途 | ライブラリ/技術 | 備考 |
|------|----------------|------|
| {目的1} | {技術1} | {補足} |
| {目的2} | {技術2} | {補足} |

```bash
# インストールコマンド（あれば）
npm install xxx
```

## 検討した選択肢

### 比較表

| 選択肢 | {評価軸1} | {評価軸2} | {評価軸3} |
|--------|-----------|-----------|-----------|
| **選択肢A** | ◎ | ○ | ○ |
| 選択肢B | ○ | △ | ◎ |
| 選択肢C | △ | ◎ | △ |

### 詳細評価

#### 選択肢A
- メリット: {理由1}
- デメリット: {理由2}

#### 選択肢B
- メリット: {理由1}
- デメリット: {理由2}

## 理由

### 選択肢Aが採用された理由
1. **{理由カテゴリ1}**: {詳細}
2. **{理由カテゴリ2}**: {詳細}
3. **{理由カテゴリ3}**: {詳細}

## 実装例（必要に応じて）

```typescript
// コード例
import { Library } from 'library'

const component = () => {
  // 実装
}
```

## 影響
- **{機能/モジュール}**: {影響内容}
- **依存パッケージ**: {追加/変更されるパッケージ}

## 参考情報
- [{名前}]({URL})
- [{名前}]({URL})
```

## ADRのカテゴリ別評価軸

### ライブラリ選定

| 評価軸 | 説明 |
|--------|------|
| 実装コスト | 導入の容易さ、学習曲線 |
| カスタマイズ自由度 | デザイン・機能の拡張性 |
| エコシステム | プラグイン、コミュニティ規模 |
| パフォーマンス | サイズ、実行速度 |
| メンテナンス | 更新頻度、セキュリティ対応 |

### アーキテクチャパターン

| 評価軸 | 説明 |
|--------|------|
| スケーラビリティ | 将来の拡張性 |
| 複雑性 | チームの理解・維持コスト |
| チーム適合性 | チームの経験・スキルセット |
| 運用コスト | デプロイ、監視、トラブルシューティング |

### データストア選定

| 評価軸 | 説明 |
|--------|------|
| データモデル | 関係型、ドキュメント型、グラフ型 |
| 整合性モデル | 強一致性、結果整合性 |
| クエリパターン | 読み取り/書き込みの特性 |
| 運用複雑性 | バックアップ、レプリケーション |

## 実行手順

1. **既存ADR確認**: `docs/adr/` を確認して最新番号を取得
2. **情報充足性チェック**: ユーザー提供の情報がADR作成に十分か判断
3. **情報不足の場合**:
   - **ask skillを呼び出して**インタビュー型プロンプティングを実施
   - 背景・制約・評価軸・候補を明確化
4. **ADR生成**: テンプレートに沿ってMarkdownファイルを作成
5. **関連ADRのリンク**: 既存ADRとの関連がある場合はリンクを追加

## ステータスの運用

| ステータス | 使用タイミング |
|----------|----------------|
| **承認済み** | 決定が確定し、実装に着手可能 |
| **提案中** | 検討中、チームのレビュー待ち |
| **却下** | 採用されなかった決定案（参考用） |
| **保留** | 一時保留、将来再検討の可能性 |
| **置換** | 新しいADRで置き換えられた古い決定 |

## ベストプラクティス

1. **番号の付与**: 既存ADRの最大番号 + 1
2. **簡潔なタイトル**: 決定内容が一目でわかるもの
3. **比較表の活用**: 選択肢を客観的に比較
4. **影響の明記**: 他機能や将来への影響を記録
5. **関連ADRのリンク**: 関連するADRに相互リンク

## 既存ADRのフォーマット例

参考として、プロジェクトの既存ADRフォーマット：

```markdown
# ADR-001: UIライブラリの選定

## ステータス
承認済み

## コンテキスト
フロントエンド開発において、UIコンポーネントライブラリとCSSフレームワークの選定が必要。

## 決定
**shadcn/ui + Tailwind CSS + Figma Kit** を採用する。

## 検討した選択肢

| ライブラリ | カスタマイズ自由度 | 学習コスト | Figma連携 |
|-----------|-------------------|-----------|----------|
| **shadcn/ui** | ◎ | ○ | ○ 公式Figma Kit |
| Radix UI | ◎ | △ | △ |

## 理由
1. **カスタマイズ自由度が高い**: コピープ方式で自由に編集可能
2. **Figma Kitの存在**: デザイナーと開発者が同じコンポーネントを共有

## 影響
- Figma Kitをデザイナーと共有し、コンポーネント名を統一する
```

## ドキュメント更新

ADRを作成したら、以下のドキュメントを更新してください：

- `docs/SUMMARY.md` - ADRセクションに追加
- `docs/_sidebar.md` - ADRセクションに追加
