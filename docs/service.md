# サービス定義書

## 1. サービス概要

| 項目 | 内容 |
|---|---|
| サービス名 | SikouLab |
| 読み方 | シコウラボ |
| タグライン | TBD |
| 名前の由来 | TBD |

### タグライン候補（例）

- 「専門家の思考を、あなたの判断材料に」
- 「読むだけで価値がある、投資情報サービス」
- 「プロの視点を、毎日あなたに」

### 名前の由来（例）

- **思考**: 専門家の思考プロセスを覗ける
- **志向**: ユーザーの投資志向に寄り添う
- **試行**: 投資判断の試行錯誤をサポート
- **ラボ**: 知見が集まる実験場・研究室

---

## 2. ミッション・ビジョン・バリュー

### ミッション（なぜこのサービスを提供するのか）

> TBD

**候補例:**
- 専門家の知見を、投資初心者でも活用できる形で届ける
- 情報過多の投資市場において、信頼できる判断材料を提供する
- ROM専ユーザーが「読むだけで満足できる」体験を創出する

### ビジョン（将来どうなりたいか）

> TBD

**候補例:**
- 日本における米国株投資の情報プラットフォームNo.1
- 専門家とユーザーをつなぐ、最も信頼されるメディア
- 投資判断の質を高める、不可欠なインフラとなる

### バリュー（大切にする価値観）

> TBD

**候補例:**
- **信頼性**: 専門家の知見に基づく、正確で偏りのない情報
- **簡潔さ**: 初心者でも理解できる、分かりやすい表現
- **継続性**: 日々更新される、新鮮な情報提供
- **受動的価値**: 能動的操作なしで価値を得られる設計

---

## 3. コンセプト TBD

### サービスの核心価値

**「専門家の記事を購読する」ことがこのサービスの売り**

- ユーザーは記事を読むためにサブスクリプションに加入する
- 記事の質と継続的な発信がサービス価値の源泉
- 銘柄情報やニュースは記事価値を補完する付加機能

### 記事購読型コミュニティとして

- 専門家の知見・思考プロセスを、初心者にも分かりやすく簡潔に提供
- ROM専ユーザーを前提とした「読むだけで価値がある体験」を最優先
- 他プラットフォームでは得られない投資判断材料を、整理されたUIで提供

---

## 4. ターゲット TBD

### メインターゲット

| ペルソナ | 特徴 |
|---|---|
| **ROM専ユーザー** | 既存Discordで閲覧のみの多数派（98.5%）。発言せずに専門家の情報を受け取りたい。能動的な操作は最小限にしたい |

### サブターゲット

| ペルソナ | 特徴 |
|---|---|
| **投資初心者** | 株式投資を始めたばかり。情報収集方法がわからず、専門用語に抵抗がある。分かりやすい解説と判断材料を求めている |
| **アクティブ投資家** | 基礎知識はあるが、大手にない差別化された分析・判断材料を求めている。迅速な情報アクセスを重視 |

### ペルソナの共通ニーズ

- 能動的な操作を最小限に抑えたい
- 専門家の視点・思考プロセスを知りたい
- 信頼できる情報源から判断材料を得たい

---

## 5. 提供価値（UVP） TBD

### ユーザーが得られるメリット

| メリット | 説明 |
|---|---|
| **専門家の知見にアクセス** | 独自の分析・思考プロセスを記事形式で継続的に受け取れる |
| **情報の一元化** | 記事・ニュース・銘柄情報が1つのプラットフォームに集約 |
| **受動的な情報収集** | ログインするだけで注目情報が整理されて表示される |
| **日本語での情報提供** | 海外ニュースも日本語に翻訳され、言語の壁なく閲覧可能 |

### 競合との差別化ポイント

> TBD

**検討観点:**
- 大手金融メディアとの違い
- 個人投資家向けSNS・コミュニティとの違い
- 有料投資情報サービスとの違い

---

## 6. サービス品質

### 6.1 パフォーマンス

**方針:** リリース前に Lighthouse CI で劣化検知、リリース後に Cloud Monitoring で継続監視

| 指標 | 目標値 | 計測タイミング | 計測ツール |
|---|---|---|---|
| ページ表示速度（LCP） | 2.5秒以内 | CI（リリース前） + 本番（継続） | Lighthouse CI + Cloud Monitoring |
| APIレスポンスタイム（p95） | 500ms以内 | 本番（継続） | Cloud Monitoring |
| 記事・ニュース表示速度 | 3秒以内 | CI（リリース前） + 本番（継続） | Lighthouse CI + Cloud Monitoring |

#### リリース前検知（Lighthouse CI）

| 項目 | 内容 |
|---|---|
| **コスト** | 無料（GitHub Actions内で実行） |
| **タイミング** | PR作成時、mainマージ時 |
| **閾値** | LCP 2.5秒未満でCI失敗または警告 |
| **結果出力** | PRコメントに詳細レポート |

**計測の仕組み:**
```
GitHub Actions (PR/マージ時)
     ↓
  Next.js ビルド
     ↓
  ローカルサーバー起動 (next start)
     ↓
  Lighthouse CI 実行
     ↓
  結果をPRコメント出力 + 閾値チェック
```

#### 本番環境監視（Cloud Monitoring）

| 項目 | 内容 |
|---|---|
| **対象** | Cloud Runのリクエストメトリクス |
| **可視化** | Cloud Monitoring ダッシュボード |
| **アラート** | 閾値超過時にCloud Consoleアプリに通知 |

**確認方法:**
1. GCPコンソール > Cloud Monitoring > ダッシュボード > 「SikouLab パフォーマンス」
2. 期間を選択してLCP、API応答時間のトレンドを確認

#### 計測の範囲

| 計測方法 | 対象 | 対象外 |
|---|---|---|
| **Lighthouse CI** | フロントエンドパフォーマンス（LCP, FCP, CLS等） | DBアクセス、外部API呼び出し |
| **Cloud Monitoring** | API応答時間、エンドポイント別レイテンシ | フロントエンドレンダリング |

### 6.2 可用性（SLA）

| 指標 | 目標値 | 計測方法 | 計測ツール |
|---|---|---|---|
| サービス稼働率 | 99.5% | Uptime Checkで定期的にヘルスチェック | Cloud Monitoring |
| メンテナンスウィンドウ | なし | - | - |

**計測の仕組み:**
- Cloud Monitoring Uptime Checkを設定（1分間隔）
- ヘルスチェックエンドポイント（`/health`）を監視
- 月間稼働率を自動計算

**Uptime Check設定:**
```
- チェック間隔: 1分
- タイムアウト: 10秒
- 対象エンドポイント: https://<domain>/health
- 失敗判定: 2回連続失敗でダウン扱い
```

**確認方法:**
1. GCPコンソール > Cloud Monitoring > Uptime Checks
2. 対象サービスの稼働率レポートを確認

### 6.3 品質（リグレッション防止）

**目的:** ユーザーにとって「新機能が使える」より「今まで使えていた機能が使えなくなる」方が影響が大きいため、リグレッションをゼロにすることを目指す。

| 指標 | 目標値 | 定義 | 記録場所 | 可視化 |
|---|---|---|---|---|
| 市場障害数 | 0件/1リリース | リリース後にユーザーまたはサービス提供者が発見した「以前動いていた機能が動かなくなった」障害 | Jira | Metabase |
| ロールバック回数 | 0回/1リリース | リリース後に障害対応としてロールバックを実施した回数 | Jira | Metabase |

**用語定義:**
- **市場障害**: リリース後に本番環境で発見された障害。E2Eテストやステージング環境で検出されたものは含まない
- **リグレッション**: 以前は正常に動作していた機能が、変更により動作しなくなること

**計測の仕組み:**

1. **Jiraでの障害管理**
   - 課題タイプ「障害」を使用
   - ラベルで分類:
     - `market-defect`: 市場障害（リリース後発見）
     - `rollback`: ロールバック実施
     - `regression`: リグレッション（以前動いていた機能の障害）
   - 「影響バージョン」フィールドでリリースバージョンを記録

2. **Metabaseでの可視化**
   - Jira APIでチケットデータを取得
   - リリースごとの市場障害数・ロールバック回数をダッシュボード化
   - トレンドグラフで品質推移を監視

**障害発生時のフロー:**
```
1. 障害発見（ユーザー報告 or 運営者検知）
     ↓
2. Jiraに市場障害チケット作成
   - ラベル: market-defect, regression（該当する場合）
   - 影響バージョン: 該当リリースバージョン
   - 優先度: 影響度に応じて設定
     ↓
3. 対応（修正 or ロールバック）
   - ロールバックの場合、ラベル「rollback」を追加
     ↓
4. リリースレビューで振り返り
   - 根本原因の分析
   - 再発防止策の検討
```

**確認方法:**
1. Metabase > ダッシュボード > 「品質メトリクス」
2. リリースバージョンでフィルタして件数を確認

### 6.4 セキュリティ

| 項目 | 方針 | 確認方法 |
|---|---|---|
| **通信暗号化** | 全通信をTLS 1.2以上で暗号化（HTTPS必須） | Cloud Run設定で強制、SSL Labsで定期確認 |
| **認証・認可** | OAuth 2.0（Google / Apple / X）による認証、ロールベースの権限制御 | 認証ログの監視（Cloud Logging） |
| **データ保護** | 個人情報の暗号化保存、アクセスログの記録・保持 | Cloud Audit Logsで記録、保持期間7日 |

### 6.5 UX原則 TBD

| 原則 | 説明 |
|---|---|
| **受動的体験最優先** | ユーザーが能動的に操作しなくても価値を得られる設計。読む体験が価値の中心 |
| **情報の整理** | 複数ソースの情報を統合し、簡潔に提供。ユーザーが情報を探し回る必要をなくす |
| **一貫性** | UIパターンと操作性の統一。学習コストを最小化し、直感的に使える |

### 6.6 品質計測の全体像

```
┌────────────────────────────────────────────────────────────────────────┐
│                           計測・可視化の仕組み                           │
├────────────────────────────────────────────────────────────────────────┤
│                                                                        │
│  [パフォーマンス]                                                       │
│  ┌─────────────────┐    ┌─────────────────┐                            │
│  │ リリース前       │    │ 本番（継続）      │                            │
│  │ Lighthouse CI   │    │ Cloud Monitoring │                            │
│  │ (GitHub Actions)│    │ (Cloud Run)     │                            │
│  └─────────────────┘    └─────────────────┘                            │
│         │                       │                                       │
│         ▼                       ▼                                       │
│  PRコメント出力          ダッシュボード + アラート                        │
│  (閾値チェック)           (Cloud Consoleアプリ)                          │
│                                                                        │
│  [可用性（SLA）]                                                        │
│  Uptime Check → Cloud Monitoring → ダッシュボード                       │
│                                                ↓                       │
│                                    月間稼働率自動計算                    │
│                                                                        │
│  [品質（リグレッション）]                                                 │
│  障害発見 → Jira（障害チケット）→ Metabase（ダッシュボード）              │
│                                                                        │
│  [セキュリティ]                                                         │
│  Cloud Run → Cloud Audit Logs → Cloud Logging                          │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘
```

**定期レビュー:**
- リリースごとに品質メトリクスをレビュー
- 市場障害が発生した場合は根本原因分析（RCA）を実施
- 四半期ごとに品質トレンドを振り返り、改善施策を検討

**品質メトリクスのサマリ:**

| カテゴリ | 計測ツール | タイミング | コスト |
|---|---|---|---|
| パフォーマンス（FE） | Lighthouse CI | PR/マージ時 | 無料 |
| パフォーマンス（全体） | Cloud Monitoring | 継続 | GCP含む |
| 可用性 | Cloud Monitoring | 継続 | GCP含む |
| リグレッション | Jira + Metabase | リリースごと | 無料 |
| セキュリティ | Cloud Logging | 継続 | GCP含む |

---

## 7. ブランドガイドライン

### 7.1 トーン&マナー

> TBD（以下から選択予定）

**選択肢A: 高級感・専門性**
- 信頼性とプロ意識を重視
- フォーマルな言葉遣い
- 落ち着いた配色、洗練されたデザイン

**選択肢B: 親しみやすさ**
- 初心者にもとっつきやすい
- カジュアルな言葉遣い
- 明るく親近感のあるデザイン

### 7.2 デザイン原則

デザインの詳細は以下のFigmaを正とする。

- **Figma URL**: https://www.figma.com/design/KLDR5porwKHiMz5EWp3ABs
- **File Key**: KLDR5porwKHiMz5EWp3ABs

**基本方針:**
- 高級感・専門性を損なわないUI/UX（要件定義書より）
- 読みやすさを最優先したタイポグラフィ
- 情報密度と余白のバランス

---

## 8. 関連ドキュメント

| ドキュメント | パス | 概要 |
|---|---|---|
| 要件定義書 | [docs/versions/1_0_0/requirements.md](./versions/1_0_0/requirements.md) | 機能要件・成功基準・スコープ |
| 基本設計書 | [docs/versions/1_0_0/system-design.md](./versions/1_0_0/system-design.md) | システム構成・画面設計・データ設計 |

