# ADR-005: staging環境の方針

## ステータス
承認済み

## コンテキスト
本番デプロイ前の確認環境としてstaging環境の必要性を検討。

現状の運用想定：
- QA担当による本番リリース前の最終確認: なし
- 外部サービス（Stripe等）との結合テスト: モック化で対応
- 本番と同等のデータ量でのテスト: すぐには必要なし

## 決定
**初期はstaging環境を構築せず、必要に応じて後から追加する。**

デプロイフロー: dev → prod 直接

## 検討した選択肢

| 評価軸 | dev → prod直接 | staging経由 |
|--------|---------------|-------------|
| 運用コスト | ◎ 環境1つ分削減 | △ 追加のインフラ費用 |
| デプロイ速度 | ◎ 速い | ○ 1ステップ増 |
| リスク管理 | △ 本番で初めて発覚する問題あり得る | ◎ 本番前に検出 |
| 初期構築コスト | ◎ 不要 | △ 環境構築が必要 |
| 後から追加 | ◎ 必要になったら追加可能 | - |

## 理由
1. **現状の運用に不要**: QA担当なし、外部サービスはモック化
2. **コスト最小化**: 初期段階では環境構築・運用コストを抑える
3. **後から追加可能**: 必要性が生じた時点で追加できる

## staging追加を検討するタイミング
- QA担当が参加し、本番リリース前確認が必要になった時
- 本番と同等のデータ量でのテストが必要になった時
- 複数チームの変更を統合してテストする必要が生じた時

## 影響
- CI/CDパイプラインは dev → prod の2環境で構築
- staging追加時はTerraform等で環境を複製できるよう設計しておく
